apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: kube-system
helmCharts:
- name: metrics-server
  releaseName: metrics-server
  version: 6.2.6
  repo: https://charts.bitnami.com/bitnami
  valuesInline:
    # nameOverride: metrics-server
    hostNetwork:
      enabled: true
    metrics:
      enabled: true
    apiService:
      create: true
    args:
      - --cert-dir=/tmp
      - --kubelet-insecure-tls
      - --secure-port=4443
      - --kubelet-use-node-status-port
      - --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname
      - --metric-resolution=15s
    containerPorts:
      https: 4443

    # args:
    #   - "--kubelet-use-node-status-port"
    #   - "--kubelet-insecure-tls"
    #   - "--authorization-always-allow-paths=/livez,/readyz,/metrics"