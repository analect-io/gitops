apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: monitoring
helmCharts:
- name: grafana
  includeCRDs: true
  releaseName: grafana
  version: 6.35.0
  repo: https://grafana.github.io/helm-charts
  valuesInline:
    fullnameOverride: grafana
    grafana.ini:
      server:
        domain: grafana.diegoluisi.eti.br
    envValueFrom:
      GF_AUTH_GITHUB_CLIENT_ID:
        secretKeyRef:
          name: grafana-secrets
          key: GF_AUTH_GITHUB_CLIENT_ID
    #   GF_AUTH_GITHUB_CLIENT_SECRET:
    #     secretKeyRef:
    #       name: grafana-secrets
    #       key: GF_AUTH_GITHUB_CLIENT_SECRET
    #   GF_SECURITY_ADMIN_PASSWORD:
    #     secretKeyRef:
    #       name: grafana-secrets
    #       key: GF_SECURITY_ADMIN_PASSWORD
    env:
      # GF_INSTALL_PLUGINS: grafana-simple-json-datasource,alexanderzobnin-zabbix-app
      GF_SERVER_DOMAIN: grafana.diegoluisi.eti.br
      GF_SERVER_ROOT_URL: "https://grafana.diegoluisi.eti.br"
      GF_AUTH_GITHUB_ENABLED: true
      GF_AUTH_GITHUB_ALLOW_SIGN_UP: true
      GF_AUTH_GITHUB_SCOPES: 'user:email,read:org'
      GF_AUTH_GITHUB_ALLOWED_ORGANIZATIONS: devxp-tech
